{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": {
          "type": "grafana",
          "uid": "-- Grafana --"
        },
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "target": {
          "limit": 100,
          "matchAny": false,
          "tags": [],
          "type": "dashboard"
        },
        "type": "dashboard"
      }
    ]
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 0,
  "id": 2,
  "links": [],
  "panels": [
    {
      "description": "",
      "fieldConfig": {
        "defaults": {},
        "overrides": []
      },
      "gridPos": {
        "h": 6,
        "w": 24,
        "x": 0,
        "y": 0
      },
      "id": 2,
      "options": {
        "code": {
          "language": "plaintext",
          "showLineNumbers": false,
          "showMiniMap": false
        },
        "content": "<div style=\"\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    background: linear-gradient(135deg, #9B68A7 0%, #7A4A7C 100%);\r\n    border: 4px solid rgba(255, 255, 255, 0.1);\r\n    border-radius: 25px;\r\n    padding: 30px 50px;\r\n    font-family: Arial, sans-serif;\r\n    color: #ffffff;\r\n    max-width: 100%;\r\n    margin: 30px auto;\r\n    box-shadow: \r\n        0 10px 20px rgba(0, 0, 0, 0.2),\r\n        inset 0 2px 10px rgba(255, 255, 255, 0.1);\r\n\">\r\n    <div style=\"flex-grow: 1;\">\r\n        <h1 style=\"\r\n            font-size: 4.2em;\r\n            margin: 10px 0;\r\n            font-weight: 800;\r\n            letter-spacing: -1px;\r\n            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);\r\n        \">Watchdog Middleware <span style=\"font-size: 0.9em;\">üê∂</span></h1>\r\n    </div>\r\n    <div style=\"\r\n        display: flex;\r\n        flex-direction: column;\r\n        align-items: flex-start;\r\n        margin-left: 40px;\r\n    \">\r\n        <p style=\"font-size: 1.3em; margin: 5px 0; font-weight: bold;\">By Rub√©n Mart√≠nez</p>\r\n        <a href=\"https://github.com/RubenMartinezSiso\" \r\n           target=\"_blank\" \r\n           style=\"text-decoration: none; display: inline-flex; align-items: center; background-color: #9B68A7; color: #ffffff; padding: 8px 20px; border-radius: 10px; font-weight: bold; font-size: 1.2em; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);\">\r\n            <span style=\"margin-right: 8px;\">üöÄ</span> Visit my GitHub\r\n        </a>\r\n    </div>\r\n</div>\r\n",
        "mode": "markdown"
      },
      "pluginVersion": "11.4.0",
      "title": "",
      "transparent": true,
      "type": "text"
    },
    {
      "collapsed": true,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 6
      },
      "id": 51,
      "panels": [
        {
          "fieldConfig": {
            "defaults": {},
            "overrides": []
          },
          "gridPos": {
            "h": 2,
            "w": 4,
            "x": 0,
            "y": 7
          },
          "id": 48,
          "options": {
            "code": {
              "language": "plaintext",
              "showLineNumbers": false,
              "showMiniMap": false
            },
            "content": "<div style=\"text-align: left; width: 100%;\">\r\n    <hr style=\"border: 1px solid white; margin-top: 5px; margin-bottom: 10px;\">\r\n    <h2 style=\"font-weight: bold; font-size: 1.8em; margin-top: 0; margin-bottom: 5px;\">Status</h2>\r\n</div>\r\n",
            "mode": "html"
          },
          "pluginVersion": "11.4.0",
          "title": "",
          "transparent": true,
          "type": "text"
        },
        {
          "fieldConfig": {
            "defaults": {},
            "overrides": []
          },
          "gridPos": {
            "h": 2,
            "w": 20,
            "x": 4,
            "y": 7
          },
          "id": 49,
          "options": {
            "code": {
              "language": "plaintext",
              "showLineNumbers": false,
              "showMiniMap": false
            },
            "content": "<div style=\"text-align: left; width: 100%;\">\r\n    <hr style=\"border: 1px solid white; margin-top: 5px; margin-bottom: 10px;\">\r\n    <h2 style=\"font-weight: bold; font-size: 1.8em; margin-top: 0; margin-bottom: 5px;\">Response Time</h2>\r\n</div>\r\n",
            "mode": "html"
          },
          "pluginVersion": "11.4.0",
          "title": "",
          "transparent": true,
          "type": "text"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus_uid"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [
                {
                  "options": {
                    "0": {
                      "color": "red",
                      "index": 1,
                      "text": "DOWN"
                    },
                    "1": {
                      "color": "green",
                      "index": 0,
                      "text": "UP"
                    }
                  },
                  "type": "value"
                }
              ],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 4,
            "x": 0,
            "y": 51
          },
          "id": 45,
          "options": {
            "colorMode": "value",
            "graphMode": "area",
            "justifyMode": "auto",
            "orientation": "auto",
            "percentChangeColorMode": "standard",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "showPercentChange": false,
            "textMode": "auto",
            "wideLayout": true
          },
          "pluginVersion": "11.4.0",
          "repeat": "apiStatus",
          "repeatDirection": "v",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "prometheus_uid"
              },
              "disableTextWrap": false,
              "editorMode": "code",
              "expr": "probe_success{instance=\"$apiStatus\"}",
              "fullMetaSearch": false,
              "includeNullMetadata": true,
              "instant": false,
              "legendFormat": "__auto",
              "range": true,
              "refId": "A",
              "useBackend": false
            }
          ],
          "title": "üåê $apiStatus",
          "type": "stat"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus_uid"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "fixedColor": "purple",
                "mode": "fixed"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 19,
                "gradientMode": "hue",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineStyle": {
                  "fill": "solid"
                },
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "auto",
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 20,
            "x": 4,
            "y": 51
          },
          "id": 46,
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": false
            },
            "tooltip": {
              "mode": "none",
              "sort": "none"
            }
          },
          "pluginVersion": "11.4.0",
          "repeat": "apiStatus",
          "repeatDirection": "v",
          "targets": [
            {
              "datasource": {
                "type": "prometheus",
                "uid": "prometheus_uid"
              },
              "disableTextWrap": false,
              "editorMode": "builder",
              "expr": "probe_duration_seconds{instance=\"$apiStatus\"}",
              "fullMetaSearch": false,
              "hide": false,
              "includeNullMetadata": true,
              "instant": false,
              "legendFormat": "__auto",
              "range": true,
              "refId": "A",
              "useBackend": false
            }
          ],
          "title": "üåê $apiStatus",
          "type": "timeseries"
        }
      ],
      "title": "üöÄ API Status Overview",
      "type": "row"
    },
    {
      "collapsed": true,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 7
      },
      "id": 50,
      "panels": [
        {
          "fieldConfig": {
            "defaults": {},
            "overrides": []
          },
          "gridPos": {
            "h": 2,
            "w": 24,
            "x": 0,
            "y": 8
          },
          "id": 23,
          "options": {
            "code": {
              "language": "plaintext",
              "showLineNumbers": false,
              "showMiniMap": false
            },
            "content": "<div style=\"text-align: left; width: 100%;\">\r\n    <hr style=\"border: 1px solid white; margin-top: 5px; margin-bottom: 10px;\">\r\n    <h2 style=\"font-weight: bold; font-size: 1.8em; margin-top: 0; margin-bottom: 5px;\">Last Requests</h2>\r\n</div>\r\n",
            "mode": "html"
          },
          "pluginVersion": "11.4.0",
          "title": "",
          "transparent": true,
          "type": "text"
        },
        {
          "datasource": {
            "type": "influxdb",
            "uid": "influx_ql_uid"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "custom": {
                "align": "left",
                "cellOptions": {
                  "type": "auto"
                },
                "filterable": true,
                "inspect": false
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "transparent"
                  }
                ]
              }
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byName",
                  "options": "Method"
                },
                "properties": [
                  {
                    "id": "custom.cellOptions",
                    "value": {
                      "applyToRow": true,
                      "mode": "gradient",
                      "type": "color-background",
                      "wrapText": false
                    }
                  },
                  {
                    "id": "mappings",
                    "value": [
                      {
                        "options": {
                          "DELETE": {
                            "color": "#f2495c80",
                            "index": 3
                          },
                          "GET": {
                            "color": "#5795f280",
                            "index": 0
                          },
                          "POST": {
                            "color": "#73bf6980",
                            "index": 1
                          },
                          "PUT": {
                            "color": "#ff983080",
                            "index": 2
                          }
                        },
                        "type": "value"
                      }
                    ]
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "Hiden Timestamp"
                },
                "properties": [
                  {
                    "id": "custom.hidden",
                    "value": true
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "Show details"
                },
                "properties": [
                  {
                    "id": "mappings",
                    "value": [
                      {
                        "options": {
                          "pattern": ".*",
                          "result": {
                            "index": 0,
                            "text": "Show details"
                          }
                        },
                        "type": "regex"
                      }
                    ]
                  },
                  {
                    "id": "links",
                    "value": [
                      {
                        "targetBlank": true,
                        "title": "Show Details",
                        "url": "/d/ee3qdl3l90zcwc/watchdog-middleware-techtiva?&var-detailsQuery=${__data.fields[\"Hiden Timestamp\"]}\n\r\n\r"
                      }
                    ]
                  },
                  {
                    "id": "custom.filterable",
                    "value": false
                  },
                  {
                    "id": "custom.cellOptions",
                    "value": {
                      "type": "color-text",
                      "wrapText": false
                    }
                  },
                  {
                    "id": "custom.width",
                    "value": 120
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "Status"
                },
                "properties": [
                  {
                    "id": "mappings",
                    "value": [
                      {
                        "options": {
                          "from": 0,
                          "result": {
                            "index": 0,
                            "text": "‚úÖ"
                          },
                          "to": 399
                        },
                        "type": "range"
                      },
                      {
                        "options": {
                          "from": 400,
                          "result": {
                            "index": 1,
                            "text": "‚ö†Ô∏è"
                          },
                          "to": 600
                        },
                        "type": "range"
                      }
                    ]
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "Date"
                },
                "properties": [
                  {
                    "id": "custom.width",
                    "value": 193
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "Status"
                },
                "properties": [
                  {
                    "id": "custom.width",
                    "value": 90
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 14,
            "w": 16,
            "x": 0,
            "y": 10
          },
          "id": 26,
          "options": {
            "cellHeight": "sm",
            "footer": {
              "countRows": true,
              "enablePagination": false,
              "fields": [],
              "reducer": [
                "count"
              ],
              "show": true
            },
            "showHeader": true,
            "sortBy": []
          },
          "pluginVersion": "11.4.0",
          "targets": [
            {
              "datasource": {
                "type": "influxdb",
                "uid": "influx_ql_uid"
              },
              "hide": false,
              "query": "SELECT\n    time,\n    req_timestamp AS \"Hiden Timestamp\", \n    req_timestamp AS \"Show details\", \n    req_api AS \"API\", \n    req_path AS \"Path\", \n    req_method AS \"Method\", \n    req_route_controller AS \"Controller\", \n    req_route_action AS \"Action\", \n    res_status_code AS \"Status\"\nFROM /^(?:$dataTable)$/\nWHERE $timeFilter AND req_api =~ /^($api)$/\nORDER BY time DESC\n",
              "rawQuery": true,
              "refId": "A",
              "resultFormat": "table"
            }
          ],
          "title": "Requests",
          "transformations": [
            {
              "id": "organize",
              "options": {
                "excludeByName": {
                  "API": false,
                  "Hiden Timestamp": false,
                  "Time": false
                },
                "includeByName": {},
                "indexByName": {
                  "API": 3,
                  "Action": 7,
                  "Controller": 6,
                  "Hiden Timestamp": 2,
                  "Method": 5,
                  "Path": 4,
                  "Show details": 0,
                  "Status": 8,
                  "Time": 1
                },
                "renameByName": {
                  "Show details": " ",
                  "Time": "Date"
                }
              }
            }
          ],
          "type": "table"
        },
        {
          "datasource": {
            "type": "influxdb",
            "uid": "influx_flux_uid"
          },
          "description": "Click on 'Show details' in the table on the left to explore the data.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "custom": {
                "align": "left",
                "cellOptions": {
                  "type": "auto"
                },
                "filterable": false,
                "inspect": false
              },
              "mappings": [],
              "noValue": "Click on 'Show details' in the table on the left to explore the data.",
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "#ffffff"
                  }
                ]
              }
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byName",
                  "options": "Value"
                },
                "properties": [
                  {
                    "id": "custom.inspect",
                    "value": true
                  },
                  {
                    "id": "custom.cellOptions",
                    "value": {
                      "type": "json-view"
                    }
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "Field"
                },
                "properties": [
                  {
                    "id": "custom.cellOptions",
                    "value": {
                      "type": "color-text",
                      "wrapText": false
                    }
                  },
                  {
                    "id": "custom.width",
                    "value": 169
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "Order"
                },
                "properties": [
                  {
                    "id": "custom.hidden",
                    "value": true
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 14,
            "w": 8,
            "x": 16,
            "y": 10
          },
          "id": 38,
          "options": {
            "cellHeight": "sm",
            "footer": {
              "countRows": false,
              "fields": "",
              "reducer": [
                "sum"
              ],
              "show": false
            },
            "frameIndex": 0,
            "showHeader": true,
            "sortBy": []
          },
          "pluginVersion": "11.4.0",
          "targets": [
            {
              "datasource": {
                "type": "influxdb",
                "uid": "influx_flux_uid"
              },
              "hide": false,
              "query": "data = from(bucket: \"$bucket\")\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\n  |> filter(fn: (r) => r[\"_measurement\"] =~ /${dataTable:regex}/)\n  |> filter(fn: (r) => contains(value: r.req_api, set: ${api:json}))\n  |> filter(fn: (r) => r[\"_field\"] == \"req_timestamp\"\n        or r[\"_field\"] == \"req_query_string\"\n        or r[\"_field\"] == \"req_body\"\n        or r[\"_field\"] == \"req_host\"\n        or r[\"_field\"] == \"req_client_ip\"\n        or r[\"_field\"] == \"req_location\"\n        or r[\"_field\"] == \"req_headers\"\n        or r[\"_field\"] == \"res_timestamp\"\n        or r[\"_field\"] == \"res_status_code\"\n        or r[\"_field\"] == \"res_body\"\n        or r[\"_field\"] == \"res_duration_ms\"\n        or r[\"_field\"] == \"res_headers\"\n        ) \n  |> pivot(rowKey:[\"_time\"], columnKey: [\"_field\"], valueColumn: \"_value\") \n  |> filter(fn: (r) => r.req_timestamp == \"$detailsQuery\")\n  |> limit(n: 1)\n\ndata\n  |> map(fn: (r) => ({\n      Order: 1,\n      Field: \"Timestamp\",\n      Value: string(v: r.req_timestamp)\n  }))\n  |> yield(name: \"1_timestamp\")\n\ndata\n  |> map(fn: (r) => ({\n      Order: 2,\n      Field: \"API\",\n      Value: string(v: r.req_api)\n  }))\n  |> yield(name: \"2_api\")\n\ndata\n  |> map(fn: (r) => ({\n      Order: 3,\n      Field: \"Path\",\n      Value: string(v: r.req_path)\n  }))\n  |> yield(name: \"3_path\")\n\ndata\n  |> map(fn: (r) => ({\n      Order: 4,\n      Field: \"Method\",\n      Value: string(v: r.req_method)\n  }))\n  |> yield(name: \"4_method\")\n\ndata\n  |> map(fn: (r) => ({\n      Order: 5,\n      Field: \"Controller\",\n      Value: string(v: r.req_route_controller)\n  }))\n  |> yield(name: \"5_controller\")\n\ndata\n  |> map(fn: (r) => ({\n      Order: 6,\n      Field: \"Action\",\n      Value: string(v: r.req_route_action)\n  }))\n  |> yield(name: \"6_action\")\n\ndata\n  |> map(fn: (r) => ({\n      Order: 7,\n      Field: \"Query String\",\n      Value: string(v: r.req_query_string)\n  }))\n  |> yield(name: \"7_query_string\")\n\ndata\n  |> map(fn: (r) => ({\n      Order: 8,\n      Field: \"Body\",\n      Value: string(v: r.req_body)\n  }))\n  |> yield(name: \"8_body\")\n\ndata\n  |> map(fn: (r) => ({\n      Order: 9,\n      Field: \"Request Host\",\n      Value: string(v: r.req_host)\n  }))\n  |> yield(name: \"9_req_host\")\n\ndata\n  |> map(fn: (r) => ({\n      Order: 10,\n      Field: \"Request IP\",\n      Value: string(v: r.req_client_ip)\n  }))\n  |> yield(name: \"10_req_ip\")\n\ndata\n  |> map(fn: (r) => ({\n      Order: 11,\n      Field: \"Request Location\",\n      Value: string(v: r.req_location)\n  }))\n  |> yield(name: \"11_req_location\")\n\ndata\n  |> map(fn: (r) => ({\n      Order: 12,\n      Field: \"Request Headers\",\n      Value: string(v: r.req_headers)\n  }))\n  |> yield(name: \"12_req_headers\")\n\ndata\n  |> map(fn: (r) => ({\n      Order: 13,\n      Field: \"Response Timestamp\",\n      Value: string(v: r.res_timestamp)\n  }))\n  |> yield(name: \"13_res_timestamp\")\n\ndata\n  |> map(fn: (r) => ({\n      Order: 14,\n      Field: \"Response Code\",\n      Value: string(v: r.res_status_code)\n  }))\n  |> yield(name: \"14_res_status_code\")\n\ndata\n  |> map(fn: (r) => ({\n      Order: 15,\n      Field: \"Response Body\",\n      Value: string(v: r.res_body)\n  }))\n  |> yield(name: \"15_res_body\")\n\ndata\n  |> map(fn: (r) => ({\n      Order: 16,\n      Field: \"Response Time (ms)\",\n      Value: string(v: r.res_duration_ms)\n  }))\n  |> yield(name: \"16_res_duration_ms\")\n\ndata\n  |> map(fn: (r) => ({\n      Order: 17,\n      Field: \"Response Headers\",\n      Value: string(v: r.res_headers)\n  }))\n  |> yield(name: \"17_res_headers\")",
              "rawQuery": true,
              "refId": "A",
              "resultFormat": "table"
            }
          ],
          "title": "Request Details",
          "transformations": [
            {
              "id": "merge",
              "options": {}
            },
            {
              "id": "sortBy",
              "options": {
                "fields": {},
                "sort": [
                  {
                    "field": "Order"
                  }
                ]
              }
            }
          ],
          "type": "table"
        },
        {
          "datasource": {
            "type": "influxdb",
            "uid": "influx_ql_uid"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "custom": {
                "align": "left",
                "cellOptions": {
                  "applyToRow": false,
                  "mode": "basic",
                  "type": "color-background",
                  "wrapText": false
                },
                "filterable": true,
                "inspect": false
              },
              "mappings": [],
              "noValue": "No errors reported",
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "#f2495c66"
                  }
                ]
              }
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byName",
                  "options": "Response Body"
                },
                "properties": [
                  {
                    "id": "custom.inspect",
                    "value": true
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "Show details"
                },
                "properties": [
                  {
                    "id": "mappings",
                    "value": [
                      {
                        "options": {
                          "pattern": ".*",
                          "result": {
                            "index": 0,
                            "text": "Show details"
                          }
                        },
                        "type": "regex"
                      }
                    ]
                  },
                  {
                    "id": "custom.filterable"
                  },
                  {
                    "id": "links",
                    "value": [
                      {
                        "title": "Show details",
                        "url": "/d/ee3qdl3l90zcwc/watchdog-middleware-techtiva?&var-detailsQuery=${__data.fields[\"Hiden Timestamp\"]}\n\r\n\r"
                      }
                    ]
                  },
                  {
                    "id": "custom.width",
                    "value": 120
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "Hiden Timestamp"
                },
                "properties": [
                  {
                    "id": "custom.hidden",
                    "value": true
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "Date"
                },
                "properties": [
                  {
                    "id": "custom.width",
                    "value": 170
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 14,
            "w": 12,
            "x": 0,
            "y": 24
          },
          "id": 27,
          "options": {
            "cellHeight": "sm",
            "footer": {
              "countRows": true,
              "enablePagination": false,
              "fields": [],
              "reducer": [
                "count"
              ],
              "show": true
            },
            "showHeader": true,
            "sortBy": []
          },
          "pluginVersion": "11.4.0",
          "targets": [
            {
              "datasource": {
                "type": "influxdb",
                "uid": "influx_ql_uid"
              },
              "hide": false,
              "query": "SELECT \n    time,\n    req_timestamp AS \"Hiden Timestamp\", \n    req_timestamp AS \"Show details\", \n    req_api AS \"API\",\n    req_path AS \"Path\",\n    req_method AS \"Method\",\n    res_status_code AS \"Code\",\n    res_body AS \"Response Body\"\nFROM /^(?:$dataTable)$/\nWHERE $timeFilter AND\n    res_status_code >= 400\n    AND req_api =~ /^($api)$/\nORDER BY \n    time DESC\n",
              "rawQuery": true,
              "refId": "A",
              "resultFormat": "table"
            }
          ],
          "title": "Errors",
          "transformations": [
            {
              "id": "organize",
              "options": {
                "excludeByName": {
                  "Hiden Timestamp": false
                },
                "includeByName": {},
                "indexByName": {
                  "API": 3,
                  "Code": 6,
                  "Hiden Timestamp": 2,
                  "Method": 5,
                  "Path": 4,
                  "Response Body": 7,
                  "Show details": 0,
                  "Time": 1
                },
                "renameByName": {
                  "Show details": " ",
                  "Time": "Date"
                }
              }
            }
          ],
          "type": "table"
        },
        {
          "datasource": {
            "type": "influxdb",
            "uid": "influx_flux_uid"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "#65c658"
                  },
                  {
                    "color": "#87ce4a",
                    "value": 200
                  },
                  {
                    "color": "#ced34c",
                    "value": 400
                  },
                  {
                    "color": "#d4ae4e",
                    "value": 600
                  },
                  {
                    "color": "#d38d4c",
                    "value": 800
                  },
                  {
                    "color": "#F2495C",
                    "value": 1000
                  }
                ]
              },
              "unit": "ms"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 14,
            "w": 12,
            "x": 12,
            "y": 24
          },
          "id": 16,
          "options": {
            "displayMode": "gradient",
            "legend": {
              "calcs": [],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": false
            },
            "maxVizHeight": 300,
            "minVizHeight": 50,
            "minVizWidth": 8,
            "namePlacement": "top",
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "/^Response Time \\(ms\\)$/",
              "limit": 5000,
              "values": true
            },
            "showUnfilled": true,
            "sizing": "manual",
            "text": {
              "titleSize": 18,
              "valueSize": 28
            },
            "valueMode": "color"
          },
          "pluginVersion": "11.4.0",
          "targets": [
            {
              "dataset": "iox",
              "datasource": {
                "type": "influxdb",
                "uid": "influx_flux_uid"
              },
              "editorMode": "code",
              "format": "table",
              "query": "from(bucket: \"$bucket\")\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\n  |> filter(fn: (r) => r[\"_measurement\"] =~ /${dataTable:regex}/)\n  |> filter(fn: (r) => r[\"_field\"] == \"res_duration_ms\")\n  |> filter(fn: (r) => contains(value: r.req_api, set: ${api:json}))\n  |> keep(columns: [\"_time\", \"_value\", \"req_path\", \"req_method\"])\n  |> map(fn: (r) => ({\n       r with \n       _value: r._value,\n       combined: r.req_path + \" - \" + r.req_method\n     }))\n  |> drop(columns: [\"req_path\", \"req_method\"])\n  |> rename(columns: {_value: \"Response Time (ms)\", combined: \"_value\"})\n  |> sort(columns: [\"_time\"], desc: true)\n",
              "rawQuery": true,
              "rawSql": "SELECT\r\n  CONCAT(req_path, ' ', req_method) AS \"Path + Method\",\r\n  res_duration_ms AS \"Response Time (ms)\"\r\nFROM \"$dataTable\"\r\nWHERE $__timeFilter(time) AND \"req_api\" IN (${api:singlequote})\r\nORDER BY time DESC\r\nLIMIT 15",
              "refId": "A",
              "resultFormat": "time_series",
              "sql": {
                "columns": [
                  {
                    "parameters": [],
                    "type": "function"
                  }
                ],
                "groupBy": [
                  {
                    "property": {
                      "type": "string"
                    },
                    "type": "groupBy"
                  }
                ]
              }
            }
          ],
          "title": "Response Times",
          "type": "bargauge"
        },
        {
          "datasource": {
            "type": "influxdb",
            "uid": "influx_ql_uid"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "custom": {
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                }
              },
              "fieldMinMax": false,
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 12,
            "w": 10,
            "x": 0,
            "y": 38
          },
          "id": 30,
          "options": {
            "basemap": {
              "config": {},
              "name": "Layer 0",
              "type": "default"
            },
            "controls": {
              "mouseWheelZoom": true,
              "showAttribution": false,
              "showDebug": false,
              "showMeasure": false,
              "showScale": false,
              "showZoom": false
            },
            "layers": [
              {
                "config": {
                  "showLegend": false,
                  "style": {
                    "color": {
                      "fixed": "dark-purple"
                    },
                    "opacity": 0.3,
                    "rotation": {
                      "fixed": 0,
                      "max": 360,
                      "min": -360,
                      "mode": "mod"
                    },
                    "size": {
                      "fixed": 5,
                      "max": 15,
                      "min": 2
                    },
                    "symbol": {
                      "fixed": "img/icons/marker/circle.svg",
                      "mode": "fixed"
                    },
                    "symbolAlign": {
                      "horizontal": "center",
                      "vertical": "bottom"
                    },
                    "text": {
                      "field": "Name",
                      "fixed": "",
                      "mode": "field"
                    },
                    "textConfig": {
                      "fontSize": 17,
                      "offsetX": 0,
                      "offsetY": 0,
                      "textAlign": "center",
                      "textBaseline": "bottom"
                    }
                  }
                },
                "location": {
                  "mode": "auto"
                },
                "name": "Count",
                "tooltip": true,
                "type": "markers"
              }
            ],
            "tooltip": {
              "mode": "details"
            },
            "view": {
              "allLayers": true,
              "id": "fit",
              "lastOnly": false,
              "lat": 41.5205,
              "layer": "Layer 1",
              "lon": 0.3459,
              "shared": false,
              "zoom": 15
            }
          },
          "pluginVersion": "11.4.0",
          "targets": [
            {
              "datasource": {
                "type": "influxdb",
                "uid": "influx_ql_uid"
              },
              "hide": false,
              "query": "SELECT \n    req_location AS \"Name\",\n    req_latitude AS \"Latitude\",\n    req_longitude AS \"Longitude\"\nFROM /^(?:$dataTable)$/\nWHERE $timeFilter AND req_api =~ /${api:regex}/\nGROUP BY req_location, req_latitude, req_longitude\n",
              "rawQuery": true,
              "refId": "A",
              "resultFormat": "table"
            }
          ],
          "title": "Geomap",
          "type": "geomap"
        },
        {
          "datasource": {
            "type": "influxdb",
            "uid": "influx_ql_uid"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "custom": {
                "align": "left",
                "cellOptions": {
                  "applyToRow": false,
                  "mode": "basic",
                  "type": "color-background",
                  "wrapText": false
                },
                "filterable": true,
                "inspect": false
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "#8e3bb83b"
                  }
                ]
              }
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byName",
                  "options": "Client IP"
                },
                "properties": [
                  {
                    "id": "custom.width",
                    "value": 300
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 12,
            "w": 14,
            "x": 10,
            "y": 38
          },
          "id": 28,
          "options": {
            "cellHeight": "sm",
            "footer": {
              "countRows": true,
              "fields": "",
              "reducer": [
                "count"
              ],
              "show": true
            },
            "showHeader": true,
            "sortBy": []
          },
          "pluginVersion": "11.4.0",
          "targets": [
            {
              "datasource": {
                "type": "influxdb",
                "uid": "influx_ql_uid"
              },
              "hide": false,
              "query": "SELECT\ntime,\nreq_host AS \"Host\",\nreq_client_ip AS \"Client IP\",\nreq_location AS \"Location\",\nreq_api AS \"API\"\nFROM /^(?:$dataTable)$/\nWHERE $timeFilter AND req_api =~ /^($api)$/\nORDER BY\ntime DESC",
              "rawQuery": true,
              "refId": "A",
              "resultFormat": "table"
            }
          ],
          "title": "Connexions",
          "transformations": [
            {
              "id": "organize",
              "options": {
                "excludeByName": {},
                "includeByName": {},
                "indexByName": {
                  "API": 4,
                  "Client IP": 1,
                  "Host": 2,
                  "Location": 3,
                  "Time": 0
                },
                "renameByName": {
                  "Time": "Date"
                }
              }
            },
            {
              "id": "groupToNestedTable",
              "options": {
                "fields": {
                  "API": {
                    "aggregations": [],
                    "operation": "groupby"
                  },
                  "Client IP": {
                    "aggregations": [],
                    "operation": "groupby"
                  },
                  "Host": {
                    "aggregations": [],
                    "operation": "groupby"
                  },
                  "Location": {
                    "aggregations": []
                  }
                },
                "showSubframeHeaders": true
              }
            }
          ],
          "type": "table"
        }
      ],
      "title": "üì• Last Requests",
      "type": "row"
    },
    {
      "collapsed": true,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 8
      },
      "id": 52,
      "panels": [
        {
          "fieldConfig": {
            "defaults": {},
            "overrides": []
          },
          "gridPos": {
            "h": 2,
            "w": 24,
            "x": 0,
            "y": 2928
          },
          "id": 18,
          "options": {
            "code": {
              "language": "plaintext",
              "showLineNumbers": false,
              "showMiniMap": false
            },
            "content": "<div style=\"text-align: left; width: 100%;\">\r\n    <hr style=\"border: 1px solid white; margin-top: 5px; margin-bottom: 10px;\">\r\n    <h2 style=\"font-weight: bold; font-size: 1.8em; margin-top: 0; margin-bottom: 5px;\">API Statistics</h2>\r\n</div>\r\n",
            "mode": "html"
          },
          "pluginVersion": "11.4.0",
          "title": "",
          "transparent": true,
          "type": "text"
        },
        {
          "datasource": {
            "type": "influxdb",
            "uid": "influx_flux_uid"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "palette-classic"
              },
              "custom": {
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                }
              },
              "mappings": []
            },
            "overrides": []
          },
          "gridPos": {
            "h": 12,
            "w": 7,
            "x": 0,
            "y": 2930
          },
          "id": 44,
          "options": {
            "displayLabels": [
              "name",
              "percent"
            ],
            "legend": {
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": false
            },
            "pieType": "pie",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": true
            },
            "tooltip": {
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "11.4.0",
          "targets": [
            {
              "datasource": {
                "type": "influxdb",
                "uid": "influx_flux_uid"
              },
              "query": "from(bucket: \"$bucket\")\r\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\r\n  |> filter(fn: (r) => r._measurement =~ /${dataTable:regex}/)\r\n  |> filter(fn: (r) => r._field == \"req_timestamp\")\r\n  |> filter(fn: (r) => exists r.req_api)\r\n  |> filter(fn: (r) => contains(value: r.req_api, set: ${api:json}))\r\n  |> group(columns: [\"req_api\"])\r\n  |> distinct(column: \"_value\")\r\n  |> count()\r\n  |> rename(columns: {_value: \"Count\", req_api: \"API\"})\r\n  |> map(fn: (r) => ({r with label: string(v: r.API) }))\r\n",
              "refId": "A"
            }
          ],
          "title": "Use of APIs",
          "type": "piechart"
        },
        {
          "datasource": {
            "type": "influxdb",
            "uid": "influx_flux_uid"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "fixedColor": "blue",
                "mode": "palette-classic"
              },
              "custom": {
                "axisBorderShow": false,
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "barWidthFactor": 0.6,
                "drawStyle": "line",
                "fillOpacity": 23,
                "gradientMode": "opacity",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "insertNulls": false,
                "lineInterpolation": "linear",
                "lineStyle": {
                  "fill": "solid"
                },
                "lineWidth": 1,
                "pointSize": 8,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "auto",
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 12,
            "w": 17,
            "x": 7,
            "y": 2930
          },
          "id": 42,
          "options": {
            "legend": {
              "calcs": [],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "11.4.0",
          "targets": [
            {
              "datasource": {
                "type": "influxdb",
                "uid": "influx_flux_uid"
              },
              "groupBy": [
                {
                  "params": [
                    "$__interval"
                  ],
                  "type": "time"
                },
                {
                  "params": [
                    "null"
                  ],
                  "type": "fill"
                }
              ],
              "orderByTime": "ASC",
              "policy": "default",
              "query": "from(bucket: \"$bucket\")\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\n  |> filter(fn: (r) => r[\"_measurement\"] =~ /${dataTable:regex}/)\n  |> filter(fn: (r) => r[\"_field\"] == \"req_timestamp\")\n  |> filter(fn: (r) => contains(value: r.req_api, set: ${api:json}))\n  |> group(columns: [\"req_api\"])\n  |> window(every: 1d)\n  |> count()\n  |> group(columns: [\"req_api\", \"_start\"])\n  |> pivot(rowKey: [\"_start\"], columnKey: [\"req_api\"], valueColumn: \"_value\")\n  |> map(fn: (r) => ({ r with time: r._start }))\n  |> yield(name: \"count_by_api_per_day\")\n",
              "rawQuery": true,
              "refId": "A",
              "resultFormat": "table",
              "select": [
                [
                  {
                    "params": [
                      "value"
                    ],
                    "type": "field"
                  },
                  {
                    "params": [],
                    "type": "mean"
                  }
                ]
              ],
              "tags": []
            }
          ],
          "title": "Request Count",
          "transformations": [
            {
              "id": "merge",
              "options": {}
            }
          ],
          "type": "timeseries"
        },
        {
          "fieldConfig": {
            "defaults": {},
            "overrides": []
          },
          "gridPos": {
            "h": 2,
            "w": 10,
            "x": 0,
            "y": 2942
          },
          "id": 40,
          "maxPerRow": 8,
          "options": {
            "code": {
              "language": "plaintext",
              "showLineNumbers": false,
              "showMiniMap": false
            },
            "content": "<div style=\"text-align: left; width: 100%;\">\n    <hr style=\"border: 1px solid white; margin-top: 5px; margin-bottom: 10px;\">\n    <h2 style=\"font-weight: bold; font-size: 1.8em; margin-top: 0; margin-bottom: 5px;\">Average Response Times</h2>\n</div>\n",
            "mode": "markdown"
          },
          "pluginVersion": "11.4.0",
          "title": "",
          "transparent": true,
          "type": "text"
        },
        {
          "fieldConfig": {
            "defaults": {},
            "overrides": []
          },
          "gridPos": {
            "h": 2,
            "w": 7,
            "x": 10,
            "y": 2942
          },
          "id": 53,
          "maxPerRow": 8,
          "options": {
            "code": {
              "language": "plaintext",
              "showLineNumbers": false,
              "showMiniMap": false
            },
            "content": "<div style=\"text-align: left; width: 100%;\">\n    <hr style=\"border: 1px solid white; margin-top: 5px; margin-bottom: 10px;\">\n    <h2 style=\"font-weight: bold; font-size: 1.8em; margin-top: 0; margin-bottom: 5px;\">Path + Method Count</h2>\n</div>\n",
            "mode": "markdown"
          },
          "pluginVersion": "11.4.0",
          "title": "",
          "transparent": true,
          "type": "text"
        },
        {
          "fieldConfig": {
            "defaults": {},
            "overrides": []
          },
          "gridPos": {
            "h": 2,
            "w": 7,
            "x": 17,
            "y": 2942
          },
          "id": 54,
          "maxPerRow": 8,
          "options": {
            "code": {
              "language": "plaintext",
              "showLineNumbers": false,
              "showMiniMap": false
            },
            "content": "<div style=\"text-align: left; width: 100%;\">\n    <hr style=\"border: 1px solid white; margin-top: 5px; margin-bottom: 10px;\">\n    <h2 style=\"font-weight: bold; font-size: 1.8em; margin-top: 0; margin-bottom: 5px;\">Controller + Action Count</h2>\n</div>\n",
            "mode": "markdown"
          },
          "pluginVersion": "11.4.0",
          "title": "",
          "transparent": true,
          "type": "text"
        },
        {
          "datasource": {
            "type": "influxdb",
            "uid": "influx_flux_uid"
          },
          "description": "",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "super-light-yellow",
                    "value": 200
                  },
                  {
                    "color": "#b3bf69",
                    "value": 400
                  },
                  {
                    "color": "#ebdb38",
                    "value": 600
                  },
                  {
                    "color": "orange",
                    "value": 800
                  },
                  {
                    "color": "red",
                    "value": 1000
                  }
                ]
              },
              "unit": "ms"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 18,
            "w": 10,
            "x": 0,
            "y": 2944
          },
          "id": 20,
          "maxPerRow": 8,
          "options": {
            "displayMode": "basic",
            "legend": {
              "calcs": [],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": false
            },
            "maxVizHeight": 300,
            "minVizHeight": 50,
            "minVizWidth": 8,
            "namePlacement": "top",
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "limit": 5000,
              "values": true
            },
            "showUnfilled": true,
            "sizing": "manual",
            "text": {
              "titleSize": 18,
              "valueSize": 28
            },
            "valueMode": "color"
          },
          "pluginVersion": "11.4.0",
          "repeat": "api",
          "repeatDirection": "v",
          "targets": [
            {
              "dataset": "iox",
              "datasource": {
                "type": "influxdb",
                "uid": "influx_flux_uid"
              },
              "editorMode": "code",
              "format": "table",
              "query": "from(bucket: \"$bucket\")\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\n  |> filter(fn: (r) => r[\"_measurement\"] =~ /${dataTable:regex}/)\n  |> filter(fn: (r) => r[\"req_api\"] == \"$api\")\n  |> filter(fn: (r) => r[\"_field\"] == \"res_duration_ms\")\n  |> group(columns: [\"req_path\", \"req_method\"])\n  |> mean(column: \"_value\")\n  |> map(fn: (r) => ({ r with title: r[\"req_path\"] + \" - \" + r[\"req_method\"] }))\n  |> sort(columns: [\"_value\"], desc: true)\n",
              "rawQuery": true,
              "rawSql": "SELECT\r\n  req_path AS \"Path\",\r\n  req_method AS \"Method\",\r\n  AVG(res_duration_ms) AS \"Avg Duration (ms)\"\r\nFROM \"$dataTable\"\r\nWHERE $__timeFilter(time) AND req_api = '$api'\r\nGROUP BY req_path, req_method\r\nORDER BY \"Avg Duration (ms)\" DESC",
              "refId": "A",
              "resultFormat": "time_series",
              "sql": {
                "columns": [
                  {
                    "parameters": [],
                    "type": "function"
                  }
                ],
                "groupBy": [
                  {
                    "property": {
                      "type": "string"
                    },
                    "type": "groupBy"
                  }
                ]
              }
            }
          ],
          "title": "üåê $api",
          "transformations": [
            {
              "id": "merge",
              "options": {}
            },
            {
              "id": "sortBy",
              "options": {
                "fields": {},
                "sort": [
                  {
                    "desc": true,
                    "field": "_value"
                  }
                ]
              }
            }
          ],
          "type": "bargauge"
        },
        {
          "datasource": {
            "type": "influxdb",
            "uid": "influx_flux_uid"
          },
          "description": "",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "fieldMinMax": false,
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "purple"
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 18,
            "w": 7,
            "x": 10,
            "y": 2944
          },
          "id": 35,
          "maxPerRow": 8,
          "options": {
            "displayMode": "basic",
            "legend": {
              "calcs": [],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": false
            },
            "maxVizHeight": 300,
            "minVizHeight": 50,
            "minVizWidth": 8,
            "namePlacement": "top",
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "limit": 5000,
              "values": true
            },
            "showUnfilled": true,
            "sizing": "manual",
            "text": {
              "titleSize": 18,
              "valueSize": 28
            },
            "valueMode": "color"
          },
          "pluginVersion": "11.4.0",
          "repeat": "api",
          "repeatDirection": "v",
          "targets": [
            {
              "datasource": {
                "type": "influxdb",
                "uid": "influx_flux_uid"
              },
              "query": "from(bucket: \"$bucket\")\r\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\r\n  |> filter(fn: (r) => r._measurement =~ /${dataTable:regex}/)\r\n  |> filter(fn: (r) => r.req_api == \"$api\")\r\n  |> group(columns: [\"req_path\", \"req_method\"])\r\n  |> count()\r\n  |> map(fn: (r) => ({\r\n       Count: r._value / 14,\r\n       title: r.req_path  + \" - \" + r.req_method\r\n     }))\r\n  |> group()\r\n  |> sort(columns: [\"Count\"], desc: true)",
              "refId": "A"
            }
          ],
          "title": "üåê $api",
          "type": "bargauge"
        },
        {
          "datasource": {
            "type": "influxdb",
            "uid": "influx_flux_uid"
          },
          "description": "\n",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "blue"
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 18,
            "w": 7,
            "x": 17,
            "y": 2944
          },
          "id": 36,
          "maxPerRow": 8,
          "options": {
            "displayMode": "basic",
            "legend": {
              "calcs": [],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": false
            },
            "maxVizHeight": 300,
            "minVizHeight": 50,
            "minVizWidth": 8,
            "namePlacement": "top",
            "orientation": "horizontal",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": true
            },
            "showUnfilled": true,
            "sizing": "manual",
            "text": {
              "titleSize": 18,
              "valueSize": 28
            },
            "valueMode": "color"
          },
          "pluginVersion": "11.4.0",
          "repeat": "api",
          "repeatDirection": "v",
          "targets": [
            {
              "datasource": {
                "type": "influxdb",
                "uid": "influx_flux_uid"
              },
              "query": "from(bucket: \"$bucket\")\r\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\r\n  |> filter(fn: (r) => r._measurement =~ /${dataTable:regex}/)\r\n  |> filter(fn: (r) => r.req_api == \"$api\")\r\n  |> group(columns: [\"req_route_controller\", \"req_route_action\"])\r\n  |> count()\r\n  |> map(fn: (r) => ({\r\n       Count: r._value / 14,\r\n       title: r.req_route_controller  + \" - \" + r.req_route_action\r\n     }))\r\n  |> group()\r\n  |> sort(columns: [\"Count\"], desc: true)",
              "refId": "A"
            }
          ],
          "title": "üåê $api",
          "type": "bargauge"
        }
      ],
      "title": "üìä API Statistics",
      "type": "row"
    },
    {
      "collapsed": true,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 9
      },
      "id": 56,
      "panels": [
        {
          "fieldConfig": {
            "defaults": {},
            "overrides": []
          },
          "gridPos": {
            "h": 2,
            "w": 24,
            "x": 0,
            "y": 10
          },
          "id": 57,
          "options": {
            "code": {
              "language": "plaintext",
              "showLineNumbers": false,
              "showMiniMap": false
            },
            "content": "<div style=\"text-align: left; width: 100%;\">\r\n    <hr style=\"border: 1px solid white; margin-top: 5px; margin-bottom: 10px;\">\r\n    <h2 style=\"font-weight: bold; font-size: 1.8em; margin-top: 0; margin-bottom: 5px;\">Checkpoint Logger</h2>\r\n</div>\r\n",
            "mode": "html"
          },
          "pluginVersion": "11.4.0",
          "title": "",
          "transparent": true,
          "type": "text"
        },
        {
          "datasource": {
            "type": "influxdb",
            "uid": "influx_ql_uid"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "custom": {
                "align": "left",
                "cellOptions": {
                  "applyToRow": true,
                  "mode": "gradient",
                  "type": "color-background"
                },
                "filterable": true,
                "inspect": false
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "#94949426"
                  }
                ]
              }
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byName",
                  "options": "Method"
                },
                "properties": [
                  {
                    "id": "custom.cellOptions",
                    "value": {
                      "applyToRow": true,
                      "mode": "gradient",
                      "type": "color-background",
                      "wrapText": false
                    }
                  },
                  {
                    "id": "mappings",
                    "value": [
                      {
                        "options": {
                          "DELETE": {
                            "color": "#f2495cb3",
                            "index": 3
                          },
                          "GET": {
                            "color": "blue",
                            "index": 0
                          },
                          "POST": {
                            "color": "green",
                            "index": 1
                          },
                          "PUT": {
                            "color": "#ff9830b3",
                            "index": 2
                          }
                        },
                        "type": "value"
                      }
                    ]
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "Message"
                },
                "properties": [
                  {
                    "id": "custom.inspect",
                    "value": true
                  },
                  {
                    "id": "custom.cellOptions",
                    "value": {
                      "type": "auto",
                      "wrapText": true
                    }
                  },
                  {
                    "id": "custom.inspect",
                    "value": false
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "Data"
                },
                "properties": [
                  {
                    "id": "custom.inspect",
                    "value": true
                  },
                  {
                    "id": "custom.cellOptions",
                    "value": {
                      "type": "json-view"
                    }
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byName",
                  "options": "Date"
                },
                "properties": [
                  {
                    "id": "custom.width",
                    "value": 200
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 13,
            "w": 24,
            "x": 0,
            "y": 12
          },
          "id": 55,
          "options": {
            "cellHeight": "md",
            "footer": {
              "countRows": true,
              "fields": "",
              "reducer": [
                "count"
              ],
              "show": true
            },
            "showHeader": true,
            "sortBy": []
          },
          "pluginVersion": "11.4.0",
          "targets": [
            {
              "datasource": {
                "type": "influxdb",
                "uid": "influx_ql_uid"
              },
              "hide": false,
              "query": "SELECT\n    time,\n    ckpt_api AS \"API\",\n    ckpt_message AS \"Message\", \n    ckpt_data AS \"Data\",\n    ckpt_path AS \"Path\", \n    ckpt_method AS \"Method\", \n    ckpt_controller AS \"Controller\", \n    ckpt_action AS \"Action\",\n    ckpt_ip AS \"IP\"\nFROM /^(?:$ckptDataTable)$/\nWHERE $timeFilter AND ckpt_api =~ /^($api)$/\nORDER BY time DESC\n",
              "rawQuery": true,
              "refId": "A",
              "resultFormat": "table"
            }
          ],
          "title": "Checkpoints",
          "transformations": [
            {
              "id": "organize",
              "options": {
                "excludeByName": {
                  "API": false,
                  "Hiden Timestamp": false,
                  "Time": false
                },
                "includeByName": {},
                "indexByName": {
                  "API": 3,
                  "Action": 7,
                  "Controller": 6,
                  "Data": 2,
                  "IP": 8,
                  "Message": 1,
                  "Method": 5,
                  "Path": 4,
                  "Time": 0
                },
                "renameByName": {
                  "Time": "Date"
                }
              }
            },
            {
              "id": "groupToNestedTable",
              "options": {
                "fields": {
                  "API": {
                    "aggregations": []
                  },
                  "Data": {
                    "aggregations": [],
                    "operation": "groupby"
                  },
                  "Date": {
                    "aggregations": [],
                    "operation": "groupby"
                  },
                  "Message": {
                    "aggregations": [],
                    "operation": "groupby"
                  },
                  "Method": {
                    "aggregations": []
                  }
                },
                "showSubframeHeaders": true
              }
            }
          ],
          "type": "table"
        },
        {
          "datasource": {
            "type": "influxdb",
            "uid": "influx_flux_uid"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "palette-classic"
              },
              "custom": {
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                }
              },
              "mappings": []
            },
            "overrides": []
          },
          "gridPos": {
            "h": 12,
            "w": 7,
            "x": 0,
            "y": 25
          },
          "id": 58,
          "options": {
            "displayLabels": [
              "name",
              "percent"
            ],
            "legend": {
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": false
            },
            "pieType": "pie",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": true
            },
            "tooltip": {
              "mode": "single",
              "sort": "none"
            }
          },
          "pluginVersion": "11.4.0",
          "targets": [
            {
              "datasource": {
                "type": "influxdb",
                "uid": "influx_flux_uid"
              },
              "query": "from(bucket: \"$bucket\")\r\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\r\n  |> filter(fn: (r) => r._measurement =~ /${ckptDataTable:regex}/)\r\n  |> filter(fn: (r) => r._field == \"ckpt_timestamp\")\r\n  |> filter(fn: (r) => exists r.ckpt_api)\r\n  |> group(columns: [\"ckpt_api\"])\r\n  |> distinct(column: \"_value\")\r\n  |> count()\r\n  |> rename(columns: {_value: \"Count\", ckpt_api: \"API\"})\r\n  |> map(fn: (r) => ({ r with label: string(v: r.API) }))\r\n",
              "refId": "A"
            }
          ],
          "title": "Use of Checkpoints",
          "type": "piechart"
        },
        {
          "datasource": {
            "type": "influxdb",
            "uid": "influx_flux_uid"
          },
          "fieldConfig": {
            "defaults": {
              "custom": {
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "scaleDistribution": {
                  "type": "linear"
                }
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 12,
            "w": 17,
            "x": 7,
            "y": 25
          },
          "id": 59,
          "options": {
            "calculate": false,
            "cellGap": 10,
            "color": {
              "exponent": 0.6,
              "fill": "#8e3bb8",
              "min": 0,
              "mode": "scheme",
              "reverse": false,
              "scale": "linear",
              "scheme": "Spectral",
              "steps": 60
            },
            "exemplars": {
              "color": "#ff00ffb3"
            },
            "filterValues": {
              "le": 1e-9
            },
            "legend": {
              "show": true
            },
            "rowsFrame": {
              "layout": "auto"
            },
            "tooltip": {
              "mode": "single",
              "showColorScale": false,
              "yHistogram": false
            },
            "yAxis": {
              "axisPlacement": "left",
              "reverse": false
            }
          },
          "pluginVersion": "11.4.0",
          "targets": [
            {
              "query": "from(bucket: \"$bucket\")\r\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\r\n  |> filter(fn: (r) => r._measurement =~ /${ckptDataTable:regex}/)\r\n  |> filter(fn: (r) => r._field == \"ckpt_timestamp\")\r\n  |> filter(fn: (r) => contains(value: r.ckpt_api, set: ${api:json}))\r\n  |> group(columns: [\"ckpt_api\"])\r\n  |> window(every: 1h)\r\n  |> count()\r\n  |> group(columns: [\"ckpt_api\", \"_start\"])\r\n  |> pivot(rowKey: [\"_start\"], columnKey: [\"ckpt_api\"], valueColumn: \"_value\")\r\n  |> map(fn: (r) => ({ r with time: r._start }))\r\n  |> yield(name: \"heatmap_data\")\r\n",
              "refId": "A"
            }
          ],
          "title": "Checkpoint Heatmap",
          "transformations": [
            {
              "id": "merge",
              "options": {}
            }
          ],
          "type": "heatmap"
        }
      ],
      "title": "üö© Checkpoint Logger",
      "type": "row"
    },
    {
      "fieldConfig": {
        "defaults": {},
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 24,
        "x": 0,
        "y": 10
      },
      "id": 60,
      "options": {
        "code": {
          "language": "plaintext",
          "showLineNumbers": false,
          "showMiniMap": false
        },
        "content": "<div style=\"\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    border-top: 2px solid rgba(155, 104, 167, 0.3);\n    padding: 20px 30px;\n    font-family: Arial, sans-serif;\n    color: #9B68A7;\n    max-width: 100%;\n    margin: 25px auto 0;\n    font-size: 1em;\n\">\n    <div style=\"flex-grow: 1;\">\n        <p style=\"margin: 0; font-size: 1.1em;\">Watchdog Middleware: Vigilant API Monitoring</p>\n        <p style=\"margin: 8px 0 0; font-size: 1em; color: #7A4A7C;\">\n            ‚öæÔ∏èüêï\n        </p>\n    </div>\n    <div style=\"\n        display: flex;\n        flex-direction: column;\n        align-items: flex-end;\n    \">\n        <a href=\"https://github.com/RubenMartinezSiso/WatchdogMiddleware\" \n           target=\"_blank\" \n           style=\"text-decoration: none; color: #9B68A7; font-weight: bold; font-size: 1.1em;\">\n            üìö Explore the Repo\n        </a>\n        <p style=\"margin: 8px 0 0; font-size: 0.9em; color: #7A4A7C;\">\n            ¬© 2025 Watchdog Middleware | v1.4.0\n        </p>\n    </div>\n</div>\n",
        "mode": "markdown"
      },
      "pluginVersion": "11.4.0",
      "title": "",
      "transparent": true,
      "type": "text"
    }
  ],
  "preload": false,
  "schemaVersion": 40,
  "tags": [],
  "templating": {
    "list": [
      {
        "current": {
          "text": "",
          "value": ""
        },
        "datasource": {
          "type": "influxdb",
          "uid": "influx_ql_uid"
        },
        "definition": "SHOW DATABASES",
        "description": "Select the InfluxDB bucket that contains your data. This is the storage container for your measurements and time series.",
        "includeAll": false,
        "label": "Bucket",
        "name": "bucket",
        "options": [],
        "query": {
          "query": "SHOW DATABASES",
          "refId": "InfluxVariableQueryEditor-VariableQuery"
        },
        "refresh": 2,
        "regex": "/^(?!_monitoring$|_tasks$).+/",
        "sort": 1,
        "type": "query"
      },
      {
        "current": {
          "text": [
            ""
          ],
          "value": [
            ""
          ]
        },
        "datasource": {
          "type": "influxdb",
          "uid": "influx_ql_uid"
        },
        "definition": "SHOW MEASUREMENTS ON \"$bucket\" WHERE \"req_api\" != ''",
        "description": "Choose the primary measurement (DataTable) that holds your API request/response data.",
        "includeAll": true,
        "label": "DataTable",
        "multi": true,
        "name": "dataTable",
        "options": [],
        "query": {
          "query": "SHOW MEASUREMENTS ON \"$bucket\" WHERE \"req_api\" != ''",
          "refId": "InfluxVariableQueryEditor-VariableQuery"
        },
        "refresh": 2,
        "regex": "",
        "sort": 1,
        "type": "query"
      },
      {
        "current": {
          "text": [
            "All"
          ],
          "value": [
            "$__all"
          ]
        },
        "datasource": {
          "type": "influxdb",
          "uid": "influx_ql_uid"
        },
        "definition": "SHOW MEASUREMENTS ON \"$bucket\" WHERE \"ckpt_api\" != ''",
        "description": "Select the measurement where checkpoints are recorded.",
        "includeAll": true,
        "label": "Checkpoint DataTable",
        "multi": true,
        "name": "ckptDataTable",
        "options": [],
        "query": {
          "query": "SHOW MEASUREMENTS ON \"$bucket\" WHERE \"ckpt_api\" != ''",
          "refId": "InfluxVariableQueryEditor-VariableQuery"
        },
        "refresh": 2,
        "regex": "",
        "type": "query"
      },
      {
        "current": {
          "text": "All",
          "value": [
            "$__all"
          ]
        },
        "datasource": {
          "type": "influxdb",
          "uid": "influx_ql_uid"
        },
        "definition": "SHOW TAG VALUES FROM /^(?:${dataTable:regex}|${ckptDataTable:regex})$/ WITH KEY IN (\"req_api\", \"ckpt_api\")",
        "description": "Pick the API identifier to filter and group your data by a specific API instance for every section.",
        "includeAll": true,
        "label": "API",
        "multi": true,
        "name": "api",
        "options": [],
        "query": {
          "query": "SHOW TAG VALUES FROM /^(?:${dataTable:regex}|${ckptDataTable:regex})$/ WITH KEY IN (\"req_api\", \"ckpt_api\")",
          "refId": "InfluxVariableQueryEditor-VariableQuery"
        },
        "refresh": 2,
        "regex": "",
        "sort": 1,
        "type": "query"
      },
      {
        "current": {
          "text": [
            "All"
          ],
          "value": [
            "$__all"
          ]
        },
        "datasource": {
          "type": "prometheus",
          "uid": "prometheus_uid"
        },
        "definition": "label_values(probe_success, instance)",
        "description": "Pick the API identifier to filter and group your data by a specific API instance ONLY for the API Status section.",
        "includeAll": true,
        "label": "API Status",
        "multi": true,
        "name": "apiStatus",
        "options": [],
        "query": {
          "qryType": 5,
          "query": "label_values(probe_success, instance)",
          "refId": "PrometheusVariableQueryEditor-VariableQuery"
        },
        "refresh": 2,
        "regex": "",
        "sort": 1,
        "type": "query"
      },
      {
        "current": {
          "text": "",
          "value": ""
        },
        "hide": 2,
        "name": "detailsQuery",
        "options": [
          {
            "selected": true,
            "text": "",
            "value": ""
          }
        ],
        "query": "",
        "type": "textbox"
      }
    ]
  },
  "time": {
    "from": "now-30d",
    "to": "now"
  },
  "timepicker": {},
  "timezone": "Europe/Madrid",
  "title": "Watchdog Middleware",
  "uid": "ee3qdl3l90zcwc",
  "version": 64,
  "weekStart": ""
}